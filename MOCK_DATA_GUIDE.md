# 模拟数据模式使用指南

## 🎯 什么是模拟数据模式？

模拟数据模式允许你在**不启动后端服务**的情况下，直接测试小程序的所有前端功能。这对前端开发和UI调试非常有用。

## ✅ 当前状态

**✨ 模拟数据模式已启用**

你现在可以直接在微信开发者工具中运行小程序，无需配置数据库和后端服务！

## 🔧 切换模式

### 启用模拟数据模式（当前状态）

打开 [miniprogram/app.js](miniprogram/app.js:9)，设置：
```javascript
useMockData: true  // ✅ 使用模拟数据
```

### 切换到真实后端模式

当后端服务启动后，修改为：
```javascript
useMockData: false  // 使用真实后端接口
```

## 📊 模拟数据内容

### 1. 服务列表（5个服务）
- 祈福法事（基础200元 + 每人50元）
- 超度法事（基础300元 + 每人80元）
- 姻缘祈福（基础180元 + 每人40元）
- 事业祈福（基础180元 + 每人40元）
- 平安符（基础100元 + 每人30元）

### 2. 时辰列表（12时辰）
- 子时、丑时、寅时、卯时、辰时、巳时
- 午时、未时、申时、酉时、戌时、亥时

### 3. 订单列表（2个示例订单）
- 订单1：祈福法事（已支付，2人）
- 订单2：姻缘祈福（待支付，1人）

### 4. 订单详情（含完整八字信息）
- 包含2位人员的完整信息
- 每位人员都有八字、五行、生肖等详细数据

## 🎮 可测试的功能

### ✅ 完全可用的功能

1. **浏览服务列表**
   - 查看所有服务
   - 点击服务进入详情页

2. **服务详情**
   - 查看服务介绍
   - 查看价格信息
   - 点击"立即预约"

3. **创建订单**（核心功能）
   - ✅ 添加多位人员
   - ✅ 填写姓名、性别
   - ✅ 选择出生日期
   - ✅ 选择出生时辰（12时辰）
   - ✅ 自动计算总金额
   - ✅ 填写地址和备注
   - ✅ 提交订单（会模拟八字计算）

4. **订单管理**
   - 查看订单列表（2个示例订单）
   - 查看订单详情（含完整八字）
   - 查看人员信息

### ⚠️ 部分功能的说明

1. **八字计算**
   - 模拟模式下会返回示例八字数据
   - 切换到真实后端后会使用 `lunar-javascript` 库进行真实计算

2. **支付功能**
   - 模拟模式下支付按钮可点击，但不会真正调起支付
   - 需要配置微信支付商户号后才能使用真实支付

3. **微信登录**
   - 模拟模式下使用固定的测试用户ID
   - 真实模式下会调用微信登录接口

## 📱 测试步骤

### 1. 打开小程序
在微信开发者工具中打开项目后，你会看到：
```
控制台输出：
🚀 小程序启动
📊 模拟数据模式: 开启
✅ 使用模拟数据，无需后端服务
```

### 2. 测试服务列表
- 首页会显示5个服务
- 点击任意服务查看详情

### 3. 测试创建订单（重点）
1. 在服务详情页点击"立即预约"
2. 填写第一位人员信息：
   - 姓名：张三
   - 性别：男
   - 出生日期：选择任意日期
   - 出生时辰：选择时辰（如"午时"）
3. 点击"+ 添加人员"添加第二位
4. 填写第二位人员信息
5. 观察总金额是否正确计算
6. 填写地址和备注（可选）
7. 点击"提交订单"

**预期结果**：
- 显示"订单创建成功"提示
- 自动跳转到订单详情页
- 可以看到人员信息和八字数据

### 4. 测试订单列表
- 切换到"订单"页面（如果有底部导航）
- 或从首页返回后通过页面链接访问
- 会看到2个示例订单

### 5. 测试订单详情
- 点击任意订单
- 查看完整的订单信息
- 查看人员八字信息

## 🐛 调试技巧

### 查看控制台日志

模拟模式下会输出详细日志：
```
📊 使用模拟服务数据
✅ 模拟订单创建成功: {order_id: 3, ...}
```

### 修改模拟数据

如果要修改测试数据，编辑 [miniprogram/utils/mockData.js](miniprogram/utils/mockData.js)：

```javascript
// 修改服务价格
const mockServices = [
  {
    id: 1,
    name: '祈福法事',
    base_price: '200.00',  // 修改这里
    price_per_person: '50.00',  // 修改这里
    // ...
  }
];

// 添加更多订单
const mockOrders = [
  // 在这里添加更多测试订单
];
```

## 🔄 切换到真实后端

当你准备测试真实后端时：

1. **启动后端服务**
```bash
cd backend
npm run dev
```

2. **修改模式**
编辑 [miniprogram/app.js](miniprogram/app.js:9)：
```javascript
useMockData: false  // 切换到真实模式
```

3. **重新编译**
在微信开发者工具中点击"编译"

4. **验证切换**
控制台应该显示：
```
🚀 小程序启动
📊 模拟数据模式: 关闭
```

## 💡 开发建议

### 前端开发阶段
- ✅ 启用模拟数据模式
- ✅ 快速迭代UI和交互
- ✅ 无需等待后端开发完成

### 联调测试阶段
- ❌ 关闭模拟数据模式
- ✅ 使用真实后端接口
- ✅ 测试真实的八字计算
- ✅ 测试数据持久化

### 上线前测试
- ❌ 确保模拟模式已关闭
- ✅ 使用线上后端地址
- ✅ 完整流程测试

## 📝 模拟数据 vs 真实数据对比

| 功能 | 模拟数据模式 | 真实后端模式 |
|------|------------|------------|
| 服务列表 | ✅ 5个固定服务 | ✅ 数据库中的服务 |
| 服务详情 | ✅ 固定数据 | ✅ 实时数据 |
| 创建订单 | ✅ 模拟成功 | ✅ 写入数据库 |
| 八字计算 | ⚠️ 示例数据 | ✅ 真实计算 |
| 订单列表 | ✅ 2个固定订单 | ✅ 用户真实订单 |
| 订单详情 | ✅ 固定详情 | ✅ 实时详情 |
| 微信登录 | ⚠️ 固定用户ID | ✅ 真实微信登录 |
| 微信支付 | ❌ 不可用 | ✅ 真实支付 |
| 数据持久化 | ❌ 页面刷新丢失 | ✅ 保存到数据库 |

## 🎉 开始测试吧！

现在你可以直接在微信开发者工具中运行小程序，体验所有前端功能了！

**不需要**：
- ❌ 安装数据库
- ❌ 配置后端环境
- ❌ 启动Node.js服务

**只需要**：
- ✅ 微信开发者工具
- ✅ 打开小程序项目
- ✅ 点击编译运行

祝测试愉快！🚀
